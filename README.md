# Simple E-commerce API

This is a Spring Boot-based RESTful API for a simple e-commerce platform. It supports product listings, cart management, order creation, user authentication with roles (customer/admin), and uses MySQL as the database.

## Features
- Product listing, search, and management (admin only for add/update/delete)
- Shopping cart management
- Order creation from cart
- User authentication (JWT) and role-based access (customer/admin)

## Technologies Used
- Java 21
- Spring Boot 3.5+
- Spring Data JPA
- Spring Security
- MySQL
- Lombok
- JWT (io.jsonwebtoken)

## Getting Started

### 1. Clone the Repository
```
git clone <your-repo-url>
cd backend
```

### 2. Configure MySQL Database
- Make sure MySQL is installed and running.
- Create a database:
  ```sql
  CREATE DATABASE ecommerce;
  ```
- Update `src/main/resources/application.properties` with your MySQL username and password:
  ```properties
  spring.datasource.url=jdbc:mysql://localhost:3306/ecommerce
  spring.datasource.username=YOUR_MYSQL_USERNAME
  spring.datasource.password=YOUR_MYSQL_PASSWORD
  spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
  spring.jpa.hibernate.ddl-auto=update
  spring.jpa.show-sql=true
  spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
  ```

### 3. Build and Run the Application
- In your IDE: Run the main class (`BackendApplication.java`)
- Or from terminal:
  ```
  mvn clean install
  mvn spring-boot:run
  ```

### 4. API Endpoints
- Product: `/products`, `/products/{id}`, `/products/search`
- Cart: `/cart`, `/cart/add`, `/cart/update`, `/cart/remove/{productId}`
- Order: `/orders`, `/orders/{id}`
- Auth: `/auth/register`, `/auth/login`

### 5. User Roles
- **Customer**: Can view products, manage cart, and place orders.
- **Admin**: Can also add, update, and delete products.

### 6. Notes
- Use tools like Postman or curl to test the API endpoints.
- JWT authentication is required for protected routes.
- The database schema is auto-generated by JPA/Hibernate.

## How to Use and Test the API (Step-by-Step)

### 1. Register a New User
- **Endpoint:** `POST /auth/register`
- **Body (JSON):**
  ```json
  {
    "username": "john",
    "password": "password123",
    "role": "CUSTOMER"
  }
  ```
- **Response:** Success message or error if username exists.

### 2. Log In to Get a JWT Token
- **Endpoint:** `POST /auth/login`
- **Body (JSON):**
  ```json
  {
    "username": "john",
    "password": "password123"
  }
  ```
- **Response:** JWT token string (copy this for the next steps).

### 3. Use the JWT Token for Protected Endpoints
- For all requests to protected endpoints, add this HTTP header:
  ```
  Authorization: Bearer <your-jwt-token>
  ```
- Example in Postman: Go to the "Authorization" tab, select "Bearer Token", and paste your token.

### 4. Example API Calls

#### Product Endpoints
- **Get all products:**
  - `GET /products`
- **Add a product (admin only):**
  - `POST /products` (Body: product JSON)
- **Update a product (admin only):**
  - `PUT /products/{id}`
- **Delete a product (admin only):**
  - `DELETE /products/{id}`
- **Search products:**
  - `GET /products/search?name=...` or `GET /products/search?category=...`

#### Cart Endpoints (customer only)
- **View cart:**
  - `GET /cart/{userId}`
- **Add item to cart:**
  - `POST /cart/{userId}/add?productId=...&quantity=...`
- **Update item quantity:**
  - `PUT /cart/{userId}/update?productId=...&quantity=...`
- **Remove item from cart:**
  - `DELETE /cart/{userId}/remove?productId=...`

#### Order Endpoints (customer only)
- **Place an order:**
  - `POST /orders/{userId}`
- **Get all orders for a user:**
  - `GET /orders/{userId}`
- **Get a specific order:**
  - `GET /orders/order/{orderId}`

### 5. Notes for New Users
- Register as a CUSTOMER to test cart and order features.
- Register as an ADMIN to test product management features.
- Always include the JWT token in the Authorization header for protected endpoints.
- Use tools like Postman or curl for testing.

## Example API Endpoints

### Product Endpoints
- **Get all products:**
  - `GET /products`
- **Get product by ID:**
  - `GET /products/{id}`
- **Add a new product:**
  - `POST /products`
- **Update a product:**
  - `PUT /products/{id}`
- **Delete a product:**
  - `DELETE /products/{id}`
- **Search products by name:**
  - `GET /products/search?name=shoes`
- **Search products by category:**
  - `GET /products/search?category=electronics`

### Order Endpoints
- **Place an order from cart:**
  - `POST /orders/{userId}`
- **Get all orders for a user:**
  - `GET /orders/{userId}`
- **Get a specific order by order ID:**
  - `GET /orders/order/{orderId}`

---

If you want to proceed with authentication (JWT, roles), reply “next”.

Example Request (using Postman)
POST http://localhost:8080/auth/register
{
  "username": "john",
  "password": "password123",
  "role": "CUSTOMER"
}
{
  "username": "admin",
  "password": "adminpass",
  "role": "ADMIN"
}

*For more details, see `requirements.md`.* 